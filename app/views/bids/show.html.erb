<%= provide(:title, "Bid")%>

<% if @bid.waiting? %>
<p class="box waiting"> This bid is still being considered by <%= @bid.receiver.name %> </p>
<% elsif @bid.accepted? %>
<p class="box verified"> This bid has been accepted by <%= @bid.receiver.name %> </p>
<% else %>
<p class="box unfinished"> This bid has been rejected by <%= @bid.receiver.name %> </p>
<% if current_user.isOwner?(@bid.receiver) && @bid.rfp.can_bid? && @bid == @bid.rfp.bids.last %>
<p2> Make a counter-bid
 <%= link_to "Make a bid", make_bid_path(@bid.rfp.id), :class => "btn btn-primary"%>
<% end %>
<% if current_user.isOwner?(@bid.sender) && @bid.rfp.can_bid? && @bid == @bid.rfp.bids.last %>
Make a new bid
<%= link_to "Make a bid", make_bid_path(@bid.rfp.id), :class => "btn btn-primary"%>
<% end %>
<% end %>


<div class="alert alert-block">
<p1 class="alert-heading"> Message</p1>
<p> <%= @bid.message %> </p>
</div>

<div class="alert alert-block">
<p1 class="alert-heading"> Offer</p1>
<p> <%= @bid.offer %> </p>
</div>

<div class="alert alert-block">
<p1 class="alert-heading"> Amount</p1>
<p> <%= @bid.amount %></p>
</div>

<div class="alert alert-block">
<p1 class="alert-heading"> Service Provided</p1>
<p> <%= @bid.service_provided %></p>
</div>

<%if current_user.isOwner?(@bid.receiver) && @bid.waiting? %>
<% if @bid.counter%>
<p> If you accept this bid, following will happen: </p>
<li> Your assets will increase by <%= @bid.amount %> </li>
<%else%>
<p> If you accept this bid, following will happen: </p>
<li> Your <%= @bid.sender.type_to_s%> will increase by <%= @bid.service_provided%> </li>
<li> Your assets will be decreased by <%= @bid.amount %> </li>
<% end %>
<% end %>
<br/>

<p>Bid: <%= @bid.amount%> vs Company: <%= @bid.receiver.assets%></p>
<p>Bid: <%= @bid.service_provided%> vs Company: <%= @bid.receiver.get_max(@bid.rfp.receiver.service_type)%></p>

<%if current_user.isOwner?(@bid.receiver) && @bid.waiting? %>
<div class="left_button">
<% if @bid.can_accept? %>
    <%= form_for(@bid) do |f| %>
      
     <%= hidden_field_tag("status", Bid.accepted) %>
     <%= hidden_field_tag("provider_id", @bid.rfp.receiver.id)%>
     <%= hidden_field_tag("buyer_id", @bid.rfp.sender.id)%>
    

      <%= f.submit "Accept", class: "btn btn-success" %>
    <% end %>
<% else %>
  <button class="btn btn-success disabled" disabled="disabled">Accept</button>
<% end %>

</div>
<div class="right_button">

    <%= form_for(@bid) do |f| %>
      
     <%= hidden_field_tag("status", Bid.rejected) %>

      <%= f.submit "Decline", class: "btn btn-danger" %>
    <% end %>
</div>
<% end %>

<p> <%= link_to @bid.rfp do %> <i class="icon-eye-open"></i> View the Original RFP <%end%> </p>
