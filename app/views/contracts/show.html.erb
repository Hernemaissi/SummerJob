<%= provide(:title, "Contract")%>
<%= stylesheet_link_tag "contracts.css" %> 
<% if @contract.under_negotiation && !current_user.teacher? && current_user.company == @contract.negotiation_receiver %>
<div class="alpha60"> <%end%>
<%= form_for(@contract) do |f| %>
          <%= render 'shared/negotiation_eror_messages', :object => f.object %>
<br/>
<h1> CONTRACT</h1>
<p3> <u><%= @contract.service_buyer.name%></u>, known as "First Party," agrees to enter into this contract with <u><%= @contract.service_provider.name %></u> , known as "Second Party" on {date}.
This agreement is based on the following terms: <br/><br/>
1. <%= @contract.bid.offer %><br/><br/>
2. Price:  <%= @contract.amount %><br/><br/>
3. Maximum amount of launches: <%= @contract.service_provider.max_capacity %><br/><br/>
Furthermore, the First Party agrees:{other items applicable to the First Party} and the Second Party agrees:{other items applicable to the Second Party} .
Invalidity or unenforceability of one or more provisions of this agreement shall not affect any other provision of this agreement.
This agreement is subject to the laws and regulations of the state of Aalto University. <br/><br/><br/>
Signed: <br/>
<br/>
<u><%= @contract.service_buyer.name %></u></br>
{First Party Name}<br/><br/>
<em><u> <p4><%= @contract.service_buyer.name%> </p4></u></em><br/>
{First Party Signature}<br/>
<br/>
<br/>
<u><%= @contract.service_provider.name %></u><br/>
{Second Party Name}<br/><br/>
<em><u> <p4><%= @contract.service_provider.name %></p4> </u></em> <br/>
{Second Party Signature}

</br></br></br></br></br> 


<% unless @contract.under_negotiation || current_user.teacher? %>

<% if !current_user.teacher? %> 
<div class="createbuttonarea">
<a class="btn" data-toggle="modal" href="#myModal">Re-negotiate contract</a>
<%end%></div>

<div class="modal hide fade" id="myModal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">Ã—</button>
    <h3>Re-negotiation form</h3>
  </div>
  <div class="modal-body">
    <div id="negotiation_form">
       
          <%= f.label :new_amount, "New Price" %>
          <div class="fieldarea">
            <%= f.text_field :new_amount %>
         </div>

        
       </div>


  <div class="modal-footer">
    <a href="#">
      <div class="fieldarea">
      <%= f.submit "Send re-negotiation request", class: "btn btn-primary" %></div>
    <% end %>
  <% end %>
 </div></a>
  </div>
</div>


<% if @contract.under_negotiation && !current_user.teacher? && current_user.company == @contract.negotiation_receiver %>
<div class="alpha60">
<div class="modal show" id="myModal">

   <div class="modal-header">
    
  <p1>  <%= @contract.negotiation_sender.name %> wishes to re-negotiate the contract with following changes: </p1>
   </div>

   <div class="modal-body">
    
   <p1 style="color:black">  New Price per launch: <%= @contract.new_amount %> </p1> </br></br>
    
  </div>

  <div class="modal-footer">
  <div id="acceptbuttoncontract">
     <%= form_tag contract_decision_path do %>
     <%= hidden_field_tag("decision", "ACC") %>
     <%= submit_tag "Accept", class: "btn btn-success" %>
     <% end %></div>
 <div id="rejectbuttoncontract">
      <%=  form_tag contract_decision_path do  %>
      <%= hidden_field_tag("decision", "REJ") %>
      <%= submit_tag "Decline", class: "btn btn-danger" %>
      <% end %></div>
  
  
</div>
</div>

<% end %>
</div>


